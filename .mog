import (
    src as up
)

v_path = [which v]

@dep(fmt)
default:

@desc(run mog, this is kinda circular)
run:
    v run .

@desc(run mog with debug output)
run_trace:
	v -d trace_logs run .

b:
	{build}

@desc(build mog into an executable)
build:
	mkdir -p release && v -prod -o release/mog . && echo built

@desc(check if code can be compiled successfully)
check:
	v -check . && echo code is good

@desc(format mog code to v standards)
fmt:
	v fmt . -w

commit:
	git add -A
	git commit for arg in {$"@"}; do -m "$arg"; done
	git push

c:
	{commit}

amend:
	git add -A
	if [ {$#} -eq 0 ]; then
		git commit --amend --no-edit
	else
		output=()
		for arg in {$"@"}; do
			output+=( "-m $arg" )
		done
		git commit --amend "${output[@]}"
	fi
	git push -f

a:
	{amend}

@desc(for testing)
test:
	echo {$bold}{v_path}{$normal_intensity}
	{up.test}
	sleep 2
	echo {$dim}{$1}
	echo Enter your name
	read name
	echo {$normal_intensity}hello ${name}
	echo {$green}${EDITOR}
	hogwash {$silence_out_err} || echo no hogwash

test2:
	pwd
	echo test2

@dep(up.test)
test3:
	echo {$#}
	echo {up.val}
	for arg in {$"@"}; do
		echo "- $arg"
	done
	pwd
